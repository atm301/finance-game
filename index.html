<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>財商小達人 - 人生理財模擬遊戲</title>
    <meta name="description" content="專為小學生設計的財商教育遊戲，學習理財概念與複利威力">
    <meta name="theme-color" content="#1e1b4b">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700;900&display=swap"
        rel="stylesheet">

    <!-- Styles -->
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/animations.css">

    <!-- Firebase SDK (選用) -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
</head>

<body>
    <!-- 浮動裝飾 -->
    <div class="floating-decorations" id="floating-decorations"></div>

    <div id="app">
        <!-- 開始畫面 -->
        <div id="start-screen" class="screen active">
            <div class="start-container">
                <div class="game-logo">
                    <span class="logo-emoji">💰</span>
                    <h1 data-i18n="game.title">財商小達人</h1>
                    <p class="subtitle" data-i18n="game.subtitle">人生理財模擬遊戲</p>
                </div>

                <!-- 登入區域 -->
                <div class="user-section">
                    <button id="login-btn" class="btn" onclick="Auth.loginWithGoogle()">
                        <svg width="18" height="18" viewBox="0 0 24 24">
                            <path fill="#4285F4"
                                d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z" />
                            <path fill="#34A853"
                                d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" />
                            <path fill="#FBBC05"
                                d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" />
                            <path fill="#EA4335"
                                d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" />
                        </svg>
                        Google 登入
                    </button>
                    <div id="user-info"></div>
                </div>

                <div class="start-description">
                    <p data-i18n="start.description1">🎯 學習理財的基本觀念</p>
                    <p data-i18n="start.description2">📈 體驗複利的神奇威力</p>
                    <p data-i18n="start.description3">🎮 模擬人生中的財務決策</p>
                </div>

                <button id="start-btn" class="btn btn-primary btn-large btn-cute">
                    <span class="btn-icon">🚀</span>
                    <span data-i18n="start.newGame">開始遊戲</span>
                </button>
                <button id="continue-btn" class="btn btn-secondary" style="display: none;">
                    <span class="btn-icon">📂</span>
                    <span data-i18n="start.continue">繼續遊戲</span>
                </button>
                <button id="achievements-btn" class="btn btn-secondary" style="margin-top: 12px;">
                    <span class="btn-icon">🏆</span>
                    成就系統
                </button>

                <!-- 設定按鈕 -->
                <div class="start-footer" style="margin-top: 24px;">
                    <button id="settings-btn" class="btn btn-icon" title="設定">⚙️</button>
                    <button id="sound-btn" class="btn btn-icon" title="音效">🔊</button>
                </div>
            </div>
        </div>

        <!-- 角色創建畫面 -->
        <div id="character-screen" class="screen">
            <div class="character-container">
                <div class="screen-header">
                    <h2 data-i18n="character.title">🌟 角色創建</h2>
                    <p data-i18n="character.subtitle">回答以下問題，決定你的起始能力！</p>
                </div>
                <div class="question-progress">
                    <div class="progress-bar">
                        <div class="progress-fill" id="question-progress"></div>
                    </div>
                    <span id="question-counter">問題 1/5</span>
                </div>
                <div id="question-container" class="question-box">
                    <!-- 問題會動態載入 -->
                </div>
                <div id="stats-preview" class="stats-preview">
                    <h3 data-i18n="character.stats">目前屬性</h3>
                    <div class="stats-grid">
                        <div class="stat-item">
                            <span class="stat-icon">🧠</span>
                            <span class="stat-name" data-i18n="stat.wisdom">智慧</span>
                            <span class="stat-value" id="preview-wisdom">0</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-icon">💪</span>
                            <span class="stat-name" data-i18n="stat.perseverance">毅力</span>
                            <span class="stat-value" id="preview-perseverance">0</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-icon">🤝</span>
                            <span class="stat-name" data-i18n="stat.social">社交</span>
                            <span class="stat-value" id="preview-social">0</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-icon">🍀</span>
                            <span class="stat-name" data-i18n="stat.luck">運氣</span>
                            <span class="stat-value" id="preview-luck">0</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 遊戲主畫面 -->
        <div id="game-screen" class="screen">
            <div class="game-container">
                <!-- 頂部狀態列 -->
                <header class="game-header">
                    <div class="header-left">
                        <span class="game-title">💰 財商小達人</span>
                    </div>
                    <div class="header-center">
                        <div class="round-info">
                            <span id="current-stage">📚 學生時期</span>
                            <span class="round-counter"><span data-i18n="game.round">回合</span> <span
                                    id="current-round">1</span>/25</span>
                        </div>
                    </div>
                    <div class="header-right">
                        <button id="sound-toggle-btn" class="btn btn-icon" title="音效">🔊</button>
                        <button id="menu-btn" class="btn btn-icon" title="選單">⚙️</button>
                    </div>
                </header>

                <!-- 主要遊戲區域 -->
                <main class="game-main">
                    <!-- 左側面板 - 角色資訊 -->
                    <aside class="panel panel-left">
                        <div class="player-card">
                            <div class="player-avatar" id="player-avatar">👤</div>
                            <div class="player-info">
                                <h3 id="player-name">玩家</h3>
                                <p id="player-age">12 歲</p>
                            </div>
                        </div>
                        <div class="player-stats">
                            <div class="stat-bar">
                                <span class="stat-label">🧠 智慧</span>
                                <div class="bar-container">
                                    <div class="bar-fill wisdom" id="stat-wisdom"></div>
                                </div>
                                <span class="stat-num" id="stat-wisdom-num">0</span>
                            </div>
                            <div class="stat-bar">
                                <span class="stat-label">💪 毅力</span>
                                <div class="bar-container">
                                    <div class="bar-fill perseverance" id="stat-perseverance"></div>
                                </div>
                                <span class="stat-num" id="stat-perseverance-num">0</span>
                            </div>
                            <div class="stat-bar">
                                <span class="stat-label">🤝 社交</span>
                                <div class="bar-container">
                                    <div class="bar-fill social" id="stat-social"></div>
                                </div>
                                <span class="stat-num" id="stat-social-num">0</span>
                            </div>
                            <div class="stat-bar">
                                <span class="stat-label">🍀 運氣</span>
                                <div class="bar-container">
                                    <div class="bar-fill luck" id="stat-luck"></div>
                                </div>
                                <span class="stat-num" id="stat-luck-num">0</span>
                            </div>
                        </div>
                    </aside>

                    <!-- 中央區域 - 事件與行動 -->
                    <section class="panel panel-center">
                        <div class="event-area" id="event-area">
                            <div class="event-card">
                                <div class="event-icon">📢</div>
                                <h3 class="event-title">歡迎來到財商小達人！</h3>
                                <p class="event-description">你即將開始你的人生理財旅程。做出明智的決策，累積財富，體驗複利的威力！</p>
                            </div>
                        </div>
                        <div class="action-area" id="action-area">
                            <h4><span data-i18n="action.title">選擇行動</span>（<span data-i18n="action.remaining">剩餘</span>
                                <span id="actions-remaining">2</span> 次）</h4>
                            <div class="action-buttons">
                                <button class="action-btn" data-action="save">
                                    <span class="action-icon">💰</span>
                                    <span class="action-name" data-i18n="action.save">儲蓄</span>
                                </button>
                                <button class="action-btn" data-action="invest">
                                    <span class="action-icon">📈</span>
                                    <span class="action-name" data-i18n="action.invest">投資</span>
                                </button>
                                <button class="action-btn" data-action="spend">
                                    <span class="action-icon">🛒</span>
                                    <span class="action-name" data-i18n="action.spend">消費</span>
                                </button>
                                <button class="action-btn" data-action="learn">
                                    <span class="action-icon">📚</span>
                                    <span class="action-name" data-i18n="action.learn">學習</span>
                                </button>
                            </div>
                        </div>
                        <button id="next-round-btn" class="btn btn-primary">
                            <span data-i18n="action.nextRound">進入下一回合</span> ➡️
                        </button>
                    </section>

                    <!-- 右側面板 - 財務狀況 -->
                    <aside class="panel panel-right">
                        <div class="finance-panel">
                            <h3 data-i18n="finance.title">💎 財務狀況</h3>
                            <div class="finance-stats">
                                <div class="finance-item">
                                    <span class="finance-icon">💵</span>
                                    <span class="finance-label" data-i18n="finance.cash">現金</span>
                                    <span class="finance-value" id="cash">500</span>
                                </div>
                                <div class="finance-item">
                                    <span class="finance-icon">📈</span>
                                    <span class="finance-label" data-i18n="finance.investments">投資資產</span>
                                    <span class="finance-value" id="investments">0</span>
                                </div>
                                <div class="finance-item">
                                    <span class="finance-icon">💳</span>
                                    <span class="finance-label" data-i18n="finance.debt">負債</span>
                                    <span class="finance-value negative" id="debt">0</span>
                                </div>
                                <div class="finance-item total">
                                    <span class="finance-icon">🏆</span>
                                    <span class="finance-label" data-i18n="finance.netWorth">總淨值</span>
                                    <span class="finance-value" id="net-worth">500</span>
                                </div>
                            </div>
                            <div class="income-expense">
                                <div class="ie-item income">
                                    <span>📥 <span data-i18n="finance.income">月收入</span></span>
                                    <span id="monthly-income">+50</span>
                                </div>
                                <div class="ie-item expense">
                                    <span>📤 <span data-i18n="finance.expense">月支出</span></span>
                                    <span id="monthly-expense">-30</span>
                                </div>
                            </div>
                        </div>
                        <div class="compound-panel">
                            <h3 data-i18n="compound.title">📊 複利成長</h3>
                            <div class="compound-chart" id="compound-chart">
                                <canvas id="growth-canvas"></canvas>
                            </div>
                            <p class="compound-tip" data-i18n="compound.tip">💡 越早投資，複利效果越明顯！</p>
                        </div>
                    </aside>
                </main>
            </div>

            <!-- 手機版底部行動列 -->
            <div class="mobile-action-bar">
                <button id="mobile-next-round-btn" class="btn btn-primary" style="width: 100%;">
                    進入下一回合 ➡️
                </button>
            </div>
        </div>

        <!-- 成就畫面 -->
        <div id="achievements-screen" class="screen">
            <div class="result-container" style="max-width: 800px;">
                <div class="screen-header">
                    <button class="btn btn-icon" id="back-from-achievements"
                        style="position: absolute; top: 20px; left: 20px;">⬅️</button>
                    <h2>🏆 成就系統</h2>
                    <p id="achievements-progress">正面成就：0/20</p>
                </div>

                <div class="achievements-tabs"
                    style="display: flex; gap: 12px; justify-content: center; margin: 24px 0;">
                    <button class="btn btn-secondary achievement-tab active" data-tab="positive">✨ 正面成就</button>
                    <button class="btn btn-secondary achievement-tab" data-tab="negative">⚠️ 負面成就</button>
                    <button class="btn btn-secondary achievement-tab" data-tab="hidden">🔮 隱藏成就</button>
                </div>

                <div class="achievements-panel" id="achievements-panel">
                    <!-- 成就動態載入 -->
                </div>
            </div>
        </div>

        <!-- 結算畫面 -->
        <div id="result-screen" class="screen">
            <div class="result-container">
                <h2 data-i18n="result.title">🎉 遊戲結束！</h2>
                <div class="result-stats">
                    <div class="result-item">
                        <span class="result-label" data-i18n="result.finalNetWorth">最終淨值</span>
                        <span class="result-value" id="final-net-worth">0</span>
                    </div>
                    <div class="result-item">
                        <span class="result-label" data-i18n="result.totalReturn">投資總收益</span>
                        <span class="result-value" id="total-investment-return">0</span>
                    </div>
                </div>
                <div class="achievements" id="result-achievements">
                    <!-- 成就動態載入 -->
                </div>
                <div class="compound-lesson">
                    <h3 data-i18n="result.lesson">📚 複利小教室</h3>
                    <p id="compound-lesson-text"></p>
                </div>
                <button id="view-all-achievements-btn" class="btn btn-secondary" style="margin-bottom: 16px;">
                    🏆 查看全部成就
                </button>
                <button id="restart-btn" class="btn btn-primary btn-large btn-cute">
                    <span data-i18n="result.restart">🔄 再玩一次</span>
                </button>
            </div>
        </div>

        <!-- 彈窗 -->
        <div id="modal" class="modal">
            <div class="modal-content" id="modal-content">
                <!-- 彈窗內容動態載入 -->
            </div>
        </div>

        <!-- 動畫效果層 -->
        <div id="animation-layer" class="animation-layer"></div>

        <!-- 成就通知區域 -->
        <div id="achievement-notifications"></div>
    </div>

    <!-- Scripts -->
    <script src="js/data.js"></script>
    <script src="js/achievements.js"></script>
    <script src="js/audio.js"></script>
    <script src="js/i18n.js"></script>
    <script src="js/tutorial.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/player.js"></script>
    <script src="js/finance.js"></script>
    <script src="js/events.js"></script>
    <script src="js/ui.js"></script>
    <script src="js/game.js"></script>

    <script>
        // 生成浮動裝飾
        document.addEventListener('DOMContentLoaded', () => {
            const container = document.getElementById('floating-decorations');
            const decorations = ['💰', '⭐', '💎', '🌟', '✨', '💵'];

            for (let i = 0; i < 15; i++) {
                const el = document.createElement('span');
                el.className = i < 8 ? 'floating-coin' : 'floating-star';
                el.textContent = decorations[Math.floor(Math.random() * decorations.length)];
                el.style.left = `${Math.random() * 100}%`;
                el.style.animationDelay = `${Math.random() * 15}s`;
                el.style.animationDuration = `${15 + Math.random() * 10}s`;
                container.appendChild(el);
            }
        });
    </script>
</body>

</html>